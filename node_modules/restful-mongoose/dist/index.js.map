{"version":3,"sources":["../src/index.js"],"names":["name","model","id","list","res","params","limit","Math","max","min","search","textSearch","language","lean","find","skip","start","exec","create","body","read","findById","update","_id","findByIdAndUpdate","$set","delete","findByIdAndRemove"],"mappings":";;;;;;kBAGe,UAASA,IAAT,EAAeC,KAAf,EAAsB;AACpC,QAAO,wCAAS;AACfC,MAAKF,IADU;;AAGfG,MAHe,sBAGEC,GAHF,EAGO;AAAA,OAAfC,MAAe,QAAfA,MAAe;;AACrB,OAAIC,QAAQC,KAAKC,GAAL,CAAS,CAAT,EAAYD,KAAKE,GAAL,CAAS,EAAT,EAAaJ,OAAOC,KAAP,GAAa,CAAb,IAAkB,EAA/B,CAAZ,CAAZ;;AAEA;AACA,OAAID,OAAOK,MAAP,IAAiB,OAAOT,MAAMU,UAAb,KAA0B,UAA/C,EAA2D;AAC1D,WAAOV,MAAMU,UAAN,CAAiBN,OAAOK,MAAxB,EAAgC;AACtCJ,YAAQA,KAD8B;AAEtCM,eAAW,IAF2B;AAGtCC,WAAO;AAH+B,KAAhC,EAIJ,iBAAMT,GAAN,CAJI,CAAP;AAKA;;AAEDH,SAAMa,IAAN,CAAW,EAAX,EAAeC,IAAf,CAAoBV,OAAOW,KAAP,GAAa,CAAb,IAAkB,CAAtC,EAAyCV,KAAzC,CAA+CA,KAA/C,EAAsDW,IAAtD,CAA2D,iBAAMb,GAAN,CAA3D;AACA,GAhBc;AAkBfc,QAlBe,yBAkBEd,GAlBF,EAkBO;AAAA,OAAbe,IAAa,SAAbA,IAAa;;AACrBlB,SAAMiB,MAAN,CAAaC,IAAb,EAAmB,iBAAMf,GAAN,CAAnB;AACA,GApBc;AAsBfgB,MAtBe,uBAsBEhB,GAtBF,EAsBO;AAAA,OAAfC,MAAe,SAAfA,MAAe;;AACrBJ,SAAMoB,QAAN,CAAehB,OAAOL,IAAP,CAAf,EAA6B,iBAAMI,GAAN,CAA7B;AACA,GAxBc;AA0BfkB,QA1Be,yBA0BUlB,GA1BV,EA0Be;AAAA,OAArBe,IAAqB,SAArBA,IAAqB;AAAA,OAAfd,MAAe,SAAfA,MAAe;;AAC7B,UAAOc,KAAKI,GAAZ;AACAtB,SAAMuB,iBAAN,CAAwBnB,OAAOL,IAAP,CAAxB,EAAsC,EAAEyB,MAAKN,IAAP,EAAtC,EAAqD,iBAAMf,GAAN,CAArD;AACA,GA7Bc;AA+BfsB,QA/Be,0BA+BItB,GA/BJ,EA+BS;AAAA,OAAfC,MAAe,SAAfA,MAAe;;AACvBJ,SAAM0B,iBAAN,CAAwBtB,OAAOL,IAAP,CAAxB,EAAsC,iBAAMI,GAAN,CAAtC;AACA;AAjCc,EAAT,CAAP;AAmCA,C;;AAvCD;;;;AACA","file":"index.js","sourcesContent":["import resource from 'resource-router-middleware';\nimport { toRes } from './util';\n\nexport default function(name, model) {\n\treturn resource({\n\t\tid : name,\n\n\t\tlist({ params }, res) {\n\t\t\tvar limit = Math.max(1, Math.min(50, params.limit|0 || 10));\n\n\t\t\t// if you have fulltext search enabled.\n\t\t\tif (params.search && typeof model.textSearch==='function') {\n\t\t\t\treturn model.textSearch(params.search, {\n\t\t\t\t\tlimit : limit,\n\t\t\t\t\tlanguage : 'en',\n\t\t\t\t\tlean : true\n\t\t\t\t}, toRes(res));\n\t\t\t}\n\n\t\t\tmodel.find({}).skip(params.start|0 || 0).limit(limit).exec(toRes(res));\n\t\t},\n\n\t\tcreate({ body }, res) {\n\t\t\tmodel.create(body, toRes(res));\n\t\t},\n\n\t\tread({ params }, res) {\n\t\t\tmodel.findById(params[name], toRes(res));\n\t\t},\n\n\t\tupdate({ body, params }, res) {\n\t\t\tdelete body._id;\n\t\t\tmodel.findByIdAndUpdate(params[name], { $set:body }, toRes(res));\n\t\t},\n\n\t\tdelete({ params }, res) {\n\t\t\tmodel.findByIdAndRemove(params[name], toRes(res));\n\t\t}\n\t});\n}\n"]}